Это статья про то, что такое майнинг (на примере сети Биткойн). (А это [homepage link](https://github.com/snordenstorm/wiki/wiki/My-Ethereum-Homepage) на всякий случай.)

#### Почему печатный станок — это печалька

Одним из ключевых свойств протокола Биткойн, благодаря которым он вообще получил признание, является невозможность "включить печатный станок", как это делают центробанки всех стран, и допечатать "на олимпиаду", "на Крым" и так далее. Ибо при каждом включении печатного станка обесцениваются те деньги, которые находятся у вас, дорогие сограждане, в руке/под подушкой/в банке. 

Поясним на коротком примере. Пусть на планете Плюк жило четыре человека, и у каждого было по 100$. Соответственно, каждый из них мог купить четверть всех богатств планеты Плюк, так как каждый из них является владельцем 100$, а суммарное количество долларов на планете было равно 400. Теперь банкир взял и допечатал себе ещё 400 долларов. У банкира стало 500 долларов, а у остальных троих осталось по 100. Таким образом, теперь банкир может купить 5/8 богатств планеты, а остальные трое — только по 1/8, в то время как до действий банкира они могли купить 1/4. Заметим, что с тем же успехом он мог превратиться в бандита, напасть на каждого из этих троих и отнять у каждого по 50$ — тогда бы у банкира (теперь уже бандита) стало 250$, а у всех остальных осталось по 50$ (и снова то же соотношение — 5/8 всех денежных запасов у бандита, по 1/8 у остальных). Экономически между допечатыванием 400$ и физическим грабежом каждого из жителей на 50$ нет никакой разницы (в этой ситуации), вот что я хочу сказать.

#### Биткойн — это избавление от [самого болезненного и самого незаметного налога](http://bitnovosti.files.wordpress.com/2014/02/durov-twit.png)

Так вот в сети Биткойн никто не может "прийти и допечатать сколько нужно" (хотя бы потому, что эта сеть является полностью децентрализованной и никем не контролируется). Выпуск биткойнов является строго плановым, гораздо более плановым даже, чем советская экономика, потому что алгоритм раз и навсегда прописан в протоколе Биткойн-сети (что-то, что является куском программного кода, всегда является более плановым, чем советская экономика). Так называемая сложность майнинга раз в две недели (каждые 2016 блоков) автоматически подстраивается так, чтобы кому-то из майнеров удавалось подписать следующий блок в среднем раз в 10 минут. (10 минут ⋅ 2016 = 2 недели.) (О том, что такое "подписать блок", сказано чуть дальше в этом документе: [здесь](https://github.com/snordenstorm/wiki/wiki/%D0%9C%D0%B0%D0%B9%D0%BD%D0%B8%D0%BD%D0%B3-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD%D0%BE%D0%B2#%D0%A7%D1%82%D0%BE-%D0%B5%D1%81%D1%82%D1%8C-%D0%BC%D0%B0%D0%B9%D0%BD%D0%B8%D0%BD%D0%B3-%D0%BD%D0%B0-%D1%81%D0%B0%D0%BC%D0%BE%D0%BC-%D0%B4%D0%B5%D0%BB%D0%B5).) Выплата за подписание блока в первые 4 года составляла 50 BTC; в последующие 4 года (и поныне, т.к. блокчейн сети Биткойн был запущен 3 января 2009 года) [она "уполовинивается"](https://en.bitcoin.it/wiki/Controlled_supply#Projected_Bitcoins_Short_Term) и составляет 25 BTC; в последующие 4 года it also would halve и составит 12.5 BTC, и так далее. При этом такая выплата происходит "из ниоткуда", и это и есть единственный способ эмиссии (появления новых монет).

Давайте произведём несложное школьное вычисление. Смотрите, в первые четыре года раз в 10 минут какой-то счастливчик (не один и тот же, разные счастливчики) получал 50 монет. Следующие четыре года раз в 10 минут какой-то счастливчик получает/будет получать 25 монет. И так далее. <br>
Что такое "четыре года раз в 10 минут"? Вот в часе шесть 10-минутных интервалов. Вопрос свёлся к тому, что такое "четыре года раз в час". Нетрудно посчитать, что это 24 ⋅ 365 ⋅ 4 = 35040 событий. "Четыре года раз в 10 минут" — это, соответственно, 6 ⋅ 35040 = 210240 событий. <br>
То есть за 4 года будет произведено 210240 выплат (каждый раз какому-то из майнеров, а именно, майнеру-победителю; смысл этого термина будет пояснён ниже). При этом в первые 4 года каждая такая выплата составит 50 BTC, во вторые четыре года каждая такая выплата составит 25 BTC... Посчитаем количество всех биткойнов, которые когда-либо будут выплачены. Это 

210240 ⋅ 50 + 210240 ⋅ 25 + 210240 ⋅ 12.5 + ... = 210240 ⋅ (50 + 25 + 12.5 + ...).

В скобках получилась геометрическая прогрессия (привет, школа!). Сумма бесконечной геометрической прогрессии, [как мы помним](https://ru.wikipedia.org/wiki/%D0%93%D0%B5%D0%BE%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F#.D0.A1.D0.B2.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0), равна b<sub>0</sub>/(1-q), где b<sub>0</sub> — начальный элемент прогрессии (в нашем случае 50), а q — множитель её (в нашем случае 1/2). Таким образом, полностью благодаря школьной математике, 50 + 25 + 12.5 + ... = 100, и полная сумма всех выплаченных когда-либо биткойнов равна 210240 ⋅ 100 = 21024000 = 21.024 millions BTC.

В предположении, что block time = 10 минут, мы получили, что за всё время существования сети будет выпущено ровно 21.024 миллионов биткойнов. Мне осталось сказать, что на самом деле block time слегка не 10 минут, а совсем чууть-чуть больше — так, что число биткойнов, которые будут выпущены за всё время существования сети, равно в точности 21 миллиону.

Мы получили, что число биткойнов ограничено самим протоколом, и скорость их добычи тоже жёстко задана протоколом. Биткойнов никогда не будет больше, чем 21 миллион — за то и любим. При всём [сумасшедшем росте](https://blockchain.info/ru/charts/difficulty?timespan=all&showDataPoints=false&daysAverageString=1&show_header=true&scale=0&address=) сложности [добыча биткойнов происходит равномерно](https://blockchain.info/ru/charts/total-bitcoins?timespan=all&showDataPoints=false&daysAverageString=1&show_header=true&scale=0&address=) и в точности как задумал создатель; отметим, что за первые 5.5 лет работы протокола добыто [немногим более 13 миллионов биткойнов](http://coinmarketcap.com/). 

#### Зачем нужен майнинг?

Это такой способ достижения децентрализованного соглашения, необходимого для проведения транзакций. В традиционных платёжных системах (Visa, Mastercard, Paypal) транзакции проходят через централизованного посредника, который списывает с тебя годовую плату за обслуживание, и, что главное, которому тебе приходится доверять. Смысл же криптовалют — исключить необходимость кому-либо доверять.

В условиях, когда каждый как бы сам себе банк, участники должны иметь возможности договариваться о том, кто кому сколько переслал. Для децентрализованности информация о транзакциях должна храниться распределённо. Отсюда следует необходимость блокчейна: публичной бухгалтерской книги, которую может загрузить на жёсткий диск каждый энтузиаст.

В процессе майнинга транзакции запаковываются в блоки. Блоки образуют цепочку блоков (блокчейн). Блокчейн хранит все когда-либо и хранится распределённо на компьютере любого энтузиаста. — 

Дочитав до технического описания майнинга, читатель может воскликнуть: ну зачем так, неужели нельзя проще? Здесь как с PGP — проще нельзя; если что-то выкинуть, безопасность сломается. В некотором смысле майнинг Биткойнов — это примитив, от которого можно отталкиваться, предлагая свои способы достижения децентрализованного соглашения.

Бывают валюты без майнинга в том понимании, в котором о нём рассказывается в этой статье. Здесь рассказывается про то, как устроен майнинг в случае (первой и пока что главной) валюты — Биткойн (PoW-майнинг, PoW = proof of work). Бывает также [PoS-майнинг](http://habrahabr.ru/post/207120/) (proof of stake), бывают гибридные (PoW/PoS, обычно с коротким временем PoW) валюты. Есть и другие идеи: proof-of-excellence (она же proof-of-play), ...

#### Что случится, когда награды за блок станут малы?

Согласно протоколу Биткойн, награда за подписание блока [каждые 4 года будет уменьшаться в 2 раза](https://en.bitcoin.it/wiki/Controlled_supply#Projected_Bitcoins_Long_Term). Одно такое "уполовинивание" мы уже пережили — в 2013 году эта награда уменьшилась с 50 BTC до 25 BTC. В 2017 нас ждёт следующее "уполовинивание" до 12.5 BTC. Уже в 2025 награда составит немногим более 3 BTC, что не выглядит сейчас слишком мотивирующе. (Многое, разумеется, зависит от курса биткойна — если мировое сообщество действительно перейдёт на биткойн и стоимость одного биткойна окажется в районе современных 100000$, как об этом многие грезят, 3 BTC не покажутся маленькой наградой.)

Доход майнера, которому удалось подписать блок, как известно, складывается из награды за подписание блока (сейчас 25 BTC) и суммы всех комиссий в этом блоке. Сейчас исчезающе малую долю этого дохода составляют комиссии; принято считать, что когда награды за нахождение блока станут пренебрежимо малыми, как раз комиссии будут основным доходом майнеров и основным стимулом для людей заниматься майнингом, и определяться размер рекомендуемой комиссии будет свободным рынком, где майнеры продают, а все пользователи — покупают услугу обработки транзакций. На данный момент размер рекомендуемой комиссии составляет 0.0001 BTC (1.5 рубля), и во многих случаях и она необязательна — комиссии на данный момент составляют пренебрежимо малую долю в доходе майнеров. (Чтобы сеть не [ддосили](https://ru.wikipedia.org/wiki/DoS-%D0%B0%D1%82%D0%B0%D0%BA%D0%B0), гоняя одни и те же транзакции по кругу, майнеры договорились брать такую комиссию.)

Однако почему именно комиссии? Не упадёт ли вместо этого сложность с околонебесной (как сейчас) до обозримой? Где будет точка равновесия — с большими комиссиями и околонебесной сложностью? Или малой сложностью и малыми комиссиями? И каково это — малая сложность — в контексте того, что "атаку 51%" станет произвести значительно дешевле?

Что это будет за фазовый переход?

Пойдём "от предпринимателя" в исследовании данной задачи. Именно, выведем условие, при котором ему выгодно докупить ещё специализированных устройств для майнинга. Давайте работать в предположении, что оборудование можно докупить непрерывно, стоит оно всегда 6000$. Мощность оборудования пусть удовлетворяет закону Мура: растёт в 2 раза каждые 2 года. В качестве начального условия возьмём современный майнер Нептун от KnC, который выдаёт 3 Thash/s и стоит 6000$ за штуку. Из закона Мура

power(t) = power(t<sub>0</sub>) ⋅ 2<sup>0.5 ⋅ (t - t<sub>0</sub>)</sup>.

Какой ежедневный профит такой майнер будет приносить? Найдём сначала общий доход участников сети в сутки. Сейчас, в 2014, награда за блок составляет 25 BTC (и будет таковой ещё до 2017); среднее время подписания блока же всегда 10 минут. Итого в сутки добывается в среднем 6 ⋅ 24 ⋅ 25 BTC = 3600 BTC. 

Вероятность подписать блок равна доле контролируемых вычислительных мощностей, поэтому в сутки докупленное устройство будет добывать 3600 BTC ⋅ (3 Thash/s ⋅ 2<sup>0.5 ⋅ (t - t<sub>0</sub>)</sup> / H). Перейдём к непрерывному пределу: доход в биткойнах за период времени dt составит db = 3600 BTC ⋅ (3 Thash/s ⋅ 2<sup>0.5 ⋅ (t - t<sub>0</sub>)</sup> / H(t)) (dt / 1 day).
(На самом деле получение BTC и происходит плавно, если майнить в пуле.)

Так что доход за сутки без учёта комиссий составит 

![BTC-доход в сутки без учёта комиссий](http://latex.codecogs.com/gif.latex?db%20%3D%203600%20%5Coperatorname%7BBTC%7D%20%5Ccdot%20%5Cfrac%7B3%20%5Coperatorname%7BThash/s%7D%20%5Ccdot%202%5E%7B0.5%20%28t_%7B%5Ctext%7Bbuy%7D%7D%20-%20t_0%29%7D%7D%7BH%28t%29%7D%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D)

Теперь неплохо бы учесть комиссии, раз мы исследуем равновесие системы, в которой есть понятия награды за подписание блока, определяемой рынком комиссии, и сложности майнинга. Вероятность подписать блок оттого, что мы "включили" в нашем исследовании комиссии, естественно, не поменяется, изменится лишь "сумма выигрыша". Именно, вместо 3600 BTC в вычислениях выше необходимо написать (3600 + (суточный доход всех майнеров от комиссий)) BTC. Чему равен суточный доход всех майнеров от комиссий? За сутки будет подписано 6 ⋅ 24 = 144 блока; пусть рыночное значение комиссии в момент времени t есть fee(t), количество транзакций в блоке — T(t). Тогда доход с одного блока есть fee(t) ⋅ T(t), доход за сутки составит 144 ⋅ fee(t) ⋅ T(t). Таким образом, доход всех майнеров за сутки с учётом комиссий равен не 3600 BTC, а 3600 BTC + 144 ⋅ fee(t) ⋅ T(t) (на самом деле, 144 ⋅ (25 + fee(t) ⋅ T(t)) BTC, 25 — та самая текущая награда за блок).

Отметим это в виде красивой формулы. BTC-доход с учётом комиссий:

![BTC-доход в сутки с учётом комиссий](http://latex.codecogs.com/gif.latex?db%20%3D%20%283600%20&plus;%20144%20%5Coperatorname%7Bfee%7D%28t%29%20T%28t%29%29%20%5Coperatorname%7BBTC%7D%20%5Ccdot%20%5Cfrac%7B3%20%5Coperatorname%7BThash/s%7D%20%5Ccdot%202%5E%7B0.5%20%28t_%7B%5Ctext%7Bbuy%7D%7D%20-%20t_0%29%7D%7D%7BH%28t%29%7D%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D)

USD-доход с учётом комиссий:

![USD-доход в сутки с учётом комиссий](http://latex.codecogs.com/gif.latex?db%20%3D%20%283600%20&plus;%20144%20%5Coperatorname%7Bfee%7D%28t%29%20T%28t%29%29%20%5Ccdot%20p%28t%29%20%5Ccdot%20%5Cfrac%7B3%20%5Coperatorname%7BThash/s%7D%20%5Ccdot%202%5E%7B0.5%20%28t_%7B%5Ctext%7Bbuy%7D%7D%20-%20t_0%29%7D%7D%7BH%28t%29%7D%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D)

Когда выгодно докупать оборудование? Когда его стоимость отобьётся, т.е. доход, полученный от устройства, превысит 6000$. Как посчитать полный доход от купленного устройства? Если пренебречь расходами на электричество и износом оборудования, ничто не мешает устройству работать вечно; полный доход составит 

![USD-условие](http://latex.codecogs.com/gif.latex?%5Cint%5Climits%5E%7B%5Cinfty%7D_%7Bt_%7B%5Ctext%7Bbuy%7D%7D%7D%20%283600%20&plus;%20144%20%5Coperatorname%7Bfee%7D%28t%29%20T%28t%29%29%20%5Ccdot%20p%28t%29%20%5Ccdot%20%5Cfrac%7B3%20%5Coperatorname%7BThash/s%7D%20%5Ccdot%202%5E%7B0.5%20%28t_%7B%5Ctext%7Bbuy%7D%7D%20-%20t_0%29%7D%7D%7BH%28t%29%7D%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D%20%3E%206000)

Эта формула замечательна и красива ровно до 2017 года, когда вместо 3600 придётся написать 1800, что на самом деле поменяет ситуацию довольно драматически. Мы же как раз это и планировали описывать: эффекты, связанные с падением в два раза. Учитывая и их, получим окончательное условие, при котором докупать майнер выгодно:

![Условие с учётом уполовинивания награды](http://latex.codecogs.com/gif.latex?%5Cint%5Climits_%7Bt_%7B%5Ctext%7Bbuy%7D%7D%7D%5E%7B%5Cinfty%7D%20144%20%5CBig%2850%20%5Ccdot%20%5Ctheta%28t-2009%29%20%5Ctheta%282013-t%29%20&plus;%2025%20%5Ccdot%20%5Ctheta%28t-2013%29%20%5Ctheta%282017-t%29%20&plus;%2012.5%20%5Ccdot%20%5Ctheta%28t-2017%29%20%5Ctheta%282021-t%29%20&plus;%20...%20&plus;%20%5Coperatorname%7Bfee%7D%28t%29%20T%28t%29%20%5CBig%29%20%5Ccdot%20p%28t%29%20%5Ccdot%20%5Cfrac%7B3%20%5Coperatorname%7BThash/s%7D%20%5Ccdot%202%5E%7B0.5%20%28t_%7B%5Ctext%7Bbuy%7D%7D%20-%20t_0%29%7D%7D%7BH%28t%29%7D%20%5Ccdot%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D%20%3E%206000%2C)

где θ(x) — [тета-функция Хевисайда](http://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F_%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0) ("ступенька"), t<sub>buy</sub> — время покупки майнера, выгодность покупки которого исследуется. Словом, это просто способ записывать кусочно-заданную функцию: выражение θ(t-2009) ⋅ θ(2013-t) равно 1 при t между 1 января 2009 года и 1 января 2013 года и равно нулю вне этого интервала.

#### Что такое майнинг-пулы?

Майнинг — процесс вероятностный: те, кому удаётся найти подходящий хэш, получают награду (50 BTC originally); те, кому не удаётся — ничего. Со временем людям играть в эту рулетку надоело (видел на Хабре комментарий человека, который в 2009-м майнил без пула: быстро подписал два блока, а потом майнил девять месяцев вхолостую, пока не подписал третий), тем более что с притоком всё новых майнеров шансы на подписание блока становились всё меньше. Люди стали объединяться в пулы (pools, mining pools). Пул — это "артель старателей", в которой майнеры объединяют свои вычислительные мощности для подписания блока; пул постоянно раздаёт участникам всё новые и новые "шары" (shares, доли, вычислительные мини-задания) и обрабатывает ответы участников; если пулу везёт и кто-то из его участников находит подходящий хэш, вся полученная награда распределяется пропорционально проделанной участниками вычислительной работе, так что свой кусок награды получает каждый. Мелкие пулы, как правило, не берут с участников вообще никакой платы; большинство предлагает рекомендуемый процент за обслуживание, но в настройках аккаунта его обычно можно установить равным нулю. (Ответ на вопрос, на что живут пулы и в чём для них экономический смысл этим заниматься, мне неизвестен. Вполне возможно, мухлюют.) Прежний способ майнинга стали называть соло-майнингом. Таким образом, пул делает доход майнера плавным, и в этом его предназначение.

Стоит также отметить такое явление, как мультипулы — пулы, которые в фоновом режиме по сложности и курсам валют вычисляют profitability всех валют и после нахождения блока перескакивают на наиболее профитную. Самым известным мультипулом, по-видимому, является [multipool.us](https://www.multipool.us/). Самым крупным пулом вообще — [ghash.io](https://ghash.io/), к которому подключены сейчас 25% всей вычислительной мощности сети Биткойн. (Что забавно, на короткое время hashrate этого пула несколько раз превысил половину hashrate'а всей сети — подробнее об этом в [этой](http://bitnovosti.com/2014/01/19/bitcoin-mainery-i-centralizaciya/), [этой](http://bitnovosti.com/2014/06/20/51-attack-again/) и [этой](http://coinspot.ru/technology/mining/pul-ghash-io-kontroliroval-51-vsej-vychislitelnoj-moshhnosti-seti/) статье.)

#### Хорошо, а что происходит при майнинге технически? В чём заключается сам процесс?

![by hand](https://pbs.twimg.com/media/BypRWkOIUAAceP9.png)

<blockquote class="twitter-tweet" lang="ru"><p>Попытка майнить биткойн вручную: выходит пара хэшей в час. Как-то непрактично получается. <a href="https://twitter.com/kenshirriff">@kenshirriff</a> <a href="http://t.co/K8qOO0GE8L">pic.twitter.com/K8qOO0GE8L</a></p></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

##### Что есть майнинг: в нулевом приближении

Майнинг это ______________, и если кому-то удастся ____________, то он молодец и получает 25 BTC.

##### Что есть майнинг: на самом деле

Сам процесс майнинга заключается в том, что ты должен подобрать такое число `nonce` (nonce — не имеющее никакого глубокого смысла число, сокращение от "number used once"), что хэш-функция `sha256(prev. block "root hash" + transactions + nonce)` даёт число, меньшее так называемого [таргета](https://en.bitcoin.it/wiki/Target) — некоторого крайне малого динамически изменяющегося числа. Соответственно, если кому-то повезло, то он предъявляет это значение `nonce` и говорит: "вот, смотрите! у меня получилось!", другие майнеры вычисляют один этот хэш и говорят: "да, чувак, хэш с участием твоего `nonce` действительно даёт число, меньшее чем target", и все переходят к поиску следующего блока. А майнер-победитель подписывает своим хэшем этот блок и получает награду за подписание блока (которая сейчас составляет 25 BTC (~10 000$)) + комиссии всех транзакций в этом блоке. Таким образом, борьба идёт за то, чтобы найти подходящий хэш, чтобы сразу после этого подписать им блок, потому что это означает, что 25 BTC награды становятся твоими.

На данный момент неизвестен способ находить такие `nonce` как-либо ещё, кроме как перебором. SHA256-хэширование используется в банковской сфере в течение десятилетий и способ восстановления прообраза по хэшу до сих пор не был обнаружен.

Таргет вычисляется по так называемой [сложности](https://en.bitcoin.it/wiki/Difficulty) майнинга. Согласно протоколу Биткойн, сложность автоматически подстраивается так, что кому-то из майнеров удаётся подписать блок в среднем раз в 10 минут. Происходит этот пересчёт сложности каждые 2016 блоков, т.е. раз в 2 недели, ибо 10 минут ⋅ 2016 = 2 недели.

hashrate = diff ⋅ 2<sup>32</sup>/time

Как происходит пересчёт? Пересчёт происходит исходя из пропорции:

last time - last diff

2 weeks - new diff

Так вот, в процессе майнинга происходит 

Current target = 00000000000000002815EE000000000000000000000000000000000000000000. Пример случайного 64-символьного (16-ричного) числа: 57AF274D01E24D0C.. (дальше мне стало лень придумывать). Глядя на current target и пример случайного числа, понятно, что  Таким образом, нужно перебором найти такое значение nonce, что `sha256 (transactions data + nonce) < current target`. 

Actual values: [current target](http://blockexplorer.com/q/hextarget), [current difficulty](http://blockexplorer.com/q/getdifficulty).

Откуда я всему научился:
https://en.bitcoin.it/wiki/Difficulty
https://en.bitcoin.it/wiki/Target. <br>
Эти ресурсы особенно хороши ссылками на "current target" или "current difficulty".


#### Почему новичку не стоит особенно задумываться о майнинге

Надо понимать, что времена 10000%-ных прибылей в майнинге прошли; в 2014 году майнинг — сложный бизнес, в котором запросто можно остаться в минусе. Времена, когда при некоторой удаче можно было намайнить себе 100 BTC (50 000$ по курсу на сентябрь 2014-го) за сутки, прошли. (Или купить за копейки — см. [динамику стоимости одного биткойна](https://blockchain.info/ru/charts/market-price?timespan=all&showDataPoints=false&daysAverageString=1&show_header=true&scale=0&address=).) Очень большое количество спецтехники по всему миру сейчас занято в майнинге, и сложность находится [около небес](https://bitinfocharts.com/ru/), и, соответственно, чтобы заниматься майнингом, нужно иметь вычислительные мощности около небес, т.е. вложить несколько десятков или сотен тысяч долларов в оборудование. 

Hashrate процессора ноутбука, с которого я всё это пишу — 2 Mhash/s; это означает, что мой процессор перебирает примерно 2 миллиона SHA256-хэшей (а именно этот алгоритм хэширования используется в Биткойн) в секунду. Hashrate всей сети Биткойн [на момент написания этой статьи равен 250 Phash/s](http://bitinfocharts.com/ru/) (Phash = 10<sup>15</sup> hash). Каждый может, конечно, майнить на своём ноуте, но в 2014 году, когда сложность находится у небес, износ оборудования и электричество дороже обойдутся. Если б я занимался соло-майнингом биткойна на своём ноуте, то шанс на то, что в ближайшие 10 минут именно я найду заветный хэш, был бы равен (2 Mhash/s)/(250 Phash/s) = (2 ⋅ 10<sup>6</sup>)/(250 ⋅ 10<sup>15</sup>) = мне лень писать столько нулей после запятой. ([Current probability of winning a block per attempt.](http://blockexplorer.com/q/probability)) Люди, впрочем, не идиоты и соло-майнингом биткойна занимаются только если контролируют сумасшедшие вычислительные мощности, иначе очень велик шанс заработать 0 BTC за всё время майнинга. Из проведённого вычисления также ясно, что в 2014 году в майнинге без специализированного оборудования, hashrate которого не 2 Mhash/s, а в тысячи раз выше, делать нечего. Собственно, в майнинге вообще никому, кроме крупных производителей спецоборудования, делать уже нечего — гораздо выгоднее делать приложения, сервисы и инфраструктуру сети Биткойн и иметь с этого деньги, свободно путешествуя по планете Земля. 

Попробуем набросать бизнес-план: вдруг получится? Планируемый KnC на третий квартал майнер Нептун будет выдавать минимум 3000 GHash/s при стоимости 6000$ за штуку. Хэшрэйт сети на сегодня (назовём этот момент времени t<sub>0</sub>) составляет [240 PHash/s](https://bitinfocharts.com/ru/): H(t<sub>0</sub>) = 240 Phash/s. Предположим, сегодня мы закупаем и сразу запускаем оборудование, которое суммарно выдавало бы 2.4 PHash/s — 1% текущей мощности сети. Для этого мы должны купить 2400/3 = 800 штук майнеров. При стоимости 6000$ за штуку это обойдётся нам в 800 ⋅ 6000$ = 0.8 ⋅ 6 millions $ = 4.8 millions $. 

Какой ежедневный профит в результате будем мы иметь? Найдём сначала общий доход участников сети в сутки. Сейчас, в 2014, награда за блок составляет 25 BTC (и будет таковой ещё до 2017); среднее время подписания блока же всегда 10 минут. Итого в сутки добывается в среднем 6 ⋅ 24 ⋅ 25 BTC = 3600 BTC. 

Вероятность подписать блок равна доле контролируемых вычислительных мощностей, поэтому в сутки нашему герою будет доставаться 3600 BTC ⋅ (2.4 Phash/s / H). Перейдём к непрерывному пределу: доход в биткойнах за период времени dt составит db = 3600 BTC ⋅ (2.4 Phash/s / H(t)) (dt / 1 day).
(На самом деле получение BTC и происходит плавно, если майнить в пуле.)

Однако же доход в биткойнах никого не волнует, если ты сначала вложил 4.8 millions $. Такого инвестора, скорее всего, интересует отбить вложения и заработать, по возможности, в долларах. Пусть db — приращение биткойнов, du — приращение долларов США, p(t) — курс, измеряющийся в USD/BTC (например: p = 500 USD/BTC, как сейчас). Тогда p(t) db = du, и du = 3600 BTC ⋅ p(t) ⋅ (2.4 Phash/s / H(t)) (dt / 1 day); окончательно, наш доход в долларах США за период времени T составит

![наш доход в долларах США за период времени T](http://latex.codecogs.com/gif.latex?%5Coperatorname%7Brevenue%7D%20%28T%29%20%3D%203600%20%5Ccdot%20%5Cint%5Climits_%7Bt_0%7D%5E%7Bt_0&plus;T%7D%20p%28t%29%20%5Cfrac%7B2.4%20%5Coperatorname%7BPhash/s%7D%7D%7BH%28t%29%7D%20%5Cfrac%7Bdt%7D%7B1%20%5Coperatorname%7Bday%7D%7D)

Посчитаем этот интеграл в предположении, что подынтегральные функции замерли на своих сегодняшних значениях. Таким образом, положим H(t) = 240 Phash/s, p(t) = 500 USD/BTC. Находя годовой доход, получим

3600 ⋅ 500 ⋅ (1/100) ⋅ 365 $ = 18 ⋅ 0.365 millions $ = 6.57 millions $. 

Пока что выглядит как полный успех, если вспомнить, что потратили на закупку оборудования мы 4.8 millions $. Выглядит так, как будто мы отбили вложения и неплохо заработали уже за первый год. Однако беглый взгляд на [график изменения полного хэшрэйта сети](https://blockchain.info/ru/charts/hash-rate?timespan=1year&daysAverageString=1&scale=0&address=) за последний год не оставляет надежды: за год он вырос приблизительно в 100 раз. Если хэшрэйт будет расти такими темпами и дальше, наш предприниматель гарантированно прогорит.

Всё это, разумеется, смягчается тем фактом, что выходят всё новые, всё более мощные поколения майнеров (закон Мура?), однако общая тенденция неутешительная. Есть ощущение, что на майнинге навариваются практически только производители спецоборудования для майнинга — АСИКов (ASICs, application-specific integrated circuits). Эти устройства не умеют ничего, кроме как вычислять SHA256-хэши. За счёт гигантского распараллеливания вычислений  . Словом, специально созданное под какую-то задачу устройство всегда побеждает устройство общего назначения (обычный компьютер).

Мы опустили в этом анализе тот факт, что p(t) — величина не вполне независимая, величина, на которую можно влиять. Курс биткойна задаётся, по сути, игроками с большой денежной массой, крупными воротилами. Но, чтобы его поднять, необходимо продавать доллары за биткойны, а в разбираемом случае у предпринимателя задача скорее обратная — отбить долларовые вложения, заработать доллары. [Высказывалось даже мнение](http://bitnovosti.com/2014/08/29/citi-miners-merchants-keeping-bitcoin-prices-check/), что от неизбежного туземуна нас всех удерживают майнеры, которым необходимо ежедневно продавать добываемые биткойны.

Отобьются ли вложенные деньги? Капитан Очевидность, глядя на приведённую выше красивую формулу, поясняет: ответ на этот вопрос зависит, в первую очередь, от того, как будет изменяться полная вычислительная мощность сети, а также от курса BTC/USD. Имея в виду также закон Мура и тот факт, что постоянно выходят всё новые и всё более мощные устройства для майнинга, устремляющие полный хэшрэйт дальше в небеса, кажется, что закупаться АСИКами и отправляться в кругосветное плавание на год — плохая идея. По крайней мере, чтобы оставаться в гонке, последние мощные модели надо постоянно докупать (и то перспективы неясные).

Этот расчёт также довольно приблизителен (не учтены ощутимые расходы на покупку блоков питания и соответствующей инфраструктуры + майнера ещё нет на рынке, спецификации могут поменяться).

Две статьи с фоточками биткойн-ферм: [первая](http://coinspot.ru/technology/mining/odna-iz-krupnejshih-bitcoin-ferm-iznutri/), [вторая](http://bitnovosti.com/2014/07/14/maining-sklady-zavody/). 